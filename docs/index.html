<!DOCTYPE html>
<html lang="cn">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>windows upgrading</title>
    <link rel="stylesheet" href="./index.css">
    <link rel="stylesheet" href="./loading.css">
    <link rel="stylesheet" href="./banner.css">
  </head>
  <body>
    <div id="controls">
      <a href="https://github.com/ppz-pro/windows-upgrading">Github</a>
    </div>
    
    <div id="windows_upgrading">
      <i>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
      </i>
      <div class="text">
        <div>正在准备 Windows</div>
        <div>请不要关闭你的计算机</div>
      </div>
    </div>
    
    <div class="banner">
      <button class="close" onclick="window.dialog_banner.showModal()">x</button>
      <dialog id="dialog_banner" on>
        <p>还想关掉我？给！我！摸！</p>
        <div class="btns">
          <button onclick="开摸()">那就摸吧</button>
        </div>
      </dialog>

      <h2>- 这么多年了工资涨没涨？有没有认真工作？</h2>
      <p>- 有认真工作，但没涨</p>
      <p>- 那还不认真摸鱼？？？</p>
    </div>
    
    <script>
      const $ = new Proxy(function() {}, { // 假 jQuery
        get(_, tagname) {
          return (props, ...children) => {
            const result = document.createElement(tagname)
            for(const key in props) {
              switch(key) {
                case 'onclick':
                  result.addEventListener('click', props[key])
                  break
                default:
                  result[key] = props[key]
              }
            }
            if (children.length)
              result.append(...children)
            return result
          }
        },
        apply(proxied, that, [selector]) {
          return document.querySelector(selector)
        }
      })

      // main
      const $window_upgrading = $('#windows_upgrading')
      $('#controls').prepend(
        $.button({ onclick: 开摸 }, '开摸！')
      )

      /** functions */
      function debug(target) {
        console.debug(target)
        return target
      }
      async function 开摸() {
        await $window_upgrading.requestPointerLock()
        $window_upgrading.requestFullscreen()
      }
    </script>
  </body>
</html>
